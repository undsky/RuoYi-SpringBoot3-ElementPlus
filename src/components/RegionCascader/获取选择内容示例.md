# el-cascader è·å–é€‰æ‹©å†…å®¹å®Œæ•´æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨ el-cascader ä¸­è·å–é€‰æ‹©çš„å†…å®¹ï¼ŒåŒ…æ‹¬é€‰ä¸­çš„å€¼å’Œå¯¹åº”çš„æ–‡æœ¬æ ‡ç­¾ã€‚

## ğŸ“‹ è·å–é€‰æ‹©å†…å®¹çš„æ–¹æ³•

### 1. **é€šè¿‡ v-model è·å–é€‰ä¸­çš„å€¼**

```vue
<template>
  <div>
    <RegionCascader
      v-model="selectedRegion"
      placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
      @change="handleRegionChange"
    />
    
    <div class="result">
      <h3>é€‰ä¸­çš„å€¼:</h3>
      <p>{{ selectedRegion }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const selectedRegion = ref([])

const handleRegionChange = (value) => {
  console.log('é€‰ä¸­çš„å€¼:', value)
  // value æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¾‹å¦‚: [110000, 110100, 110101]
}
</script>
```

### 2. **é€šè¿‡ change äº‹ä»¶è·å–å€¼å’Œæ ‡ç­¾**

```vue
<template>
  <div>
    <RegionCascader
      v-model="selectedRegion"
      placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
      @change-with-labels="handleRegionChangeWithLabels"
    />
    
    <div class="result">
      <h3>é€‰æ‹©ç»“æœ:</h3>
      <p>é€‰ä¸­çš„å€¼: {{ selectedValues }}</p>
      <p>é€‰ä¸­çš„æ ‡ç­¾: {{ selectedLabels }}</p>
      <p>å®Œæ•´æ–‡æœ¬: {{ selectedText }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const selectedRegion = ref([])
const selectedValues = ref([])
const selectedLabels = ref([])
const selectedText = ref('')

const handleRegionChangeWithLabels = (data) => {
  selectedValues.value = data.values
  selectedLabels.value = data.labels
  selectedText.value = data.labels.join(' / ')
  
  console.log('é€‰ä¸­çš„å€¼:', data.values)
  console.log('é€‰ä¸­çš„æ ‡ç­¾:', data.labels)
  console.log('å®Œæ•´æ–‡æœ¬:', data.labels.join(' / '))
}
</script>
```

### 3. **é€šè¿‡ç»„ä»¶å¼•ç”¨è·å–é€‰æ‹©å†…å®¹**

```vue
<template>
  <div>
    <RegionCascader
      ref="regionCascaderRef"
      v-model="selectedRegion"
      placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
    />
    
    <div class="buttons">
      <el-button @click="getSelectedInfo">è·å–é€‰æ‹©ä¿¡æ¯</el-button>
      <el-button @click="getLabelsOnly">åªè·å–æ ‡ç­¾</el-button>
      <el-button @click="getCompleteInfo">è·å–å®Œæ•´ä¿¡æ¯</el-button>
    </div>
    
    <div class="result">
      <h3>è·å–ç»“æœ:</h3>
      <pre>{{ resultInfo }}</pre>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const regionCascaderRef = ref()
const selectedRegion = ref([])
const resultInfo = ref('')

const getSelectedInfo = () => {
  const info = regionCascaderRef.value.getSelectedInfo()
  resultInfo.value = JSON.stringify(info, null, 2)
  console.log('å®Œæ•´ä¿¡æ¯:', info)
}

const getLabelsOnly = () => {
  const labels = regionCascaderRef.value.getLabels()
  resultInfo.value = JSON.stringify(labels, null, 2)
  console.log('æ ‡ç­¾æ•°ç»„:', labels)
}

const getCompleteInfo = () => {
  const info = regionCascaderRef.value.getSelectedInfo()
  resultInfo.value = `
é€‰ä¸­çš„å€¼: ${info.values.join(', ')}
é€‰ä¸­çš„æ ‡ç­¾: ${info.labels.join(', ')}
å®Œæ•´æ–‡æœ¬: ${info.text}
  `
  console.log('å®Œæ•´ä¿¡æ¯:', info)
}
</script>

<style scoped>
.result {
  margin-top: 20px;
  padding: 15px;
  background-color: #f5f5f5;
  border-radius: 4px;
}

.buttons {
  margin-top: 20px;
}

.buttons .el-button {
  margin-right: 10px;
}

pre {
  background-color: #fff;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #ddd;
}
</style>
```

## ğŸ”§ å®é™…åº”ç”¨åœºæ™¯

### 1. **è¡¨å•æäº¤æ—¶è·å–å®Œæ•´ä¿¡æ¯**

```vue
<template>
  <el-form :model="form" :rules="rules" ref="formRef" label-width="100px">
    <el-form-item label="é¡¹ç›®åç§°" prop="projectName">
      <el-input v-model="form.projectName" placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°" />
    </el-form-item>
    
    <el-form-item label="æ‰€åœ¨åŒºåŸŸ" prop="region">
      <RegionCascader
        v-model="form.region"
        placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
        @change-with-labels="handleRegionChange"
      />
    </el-form-item>
    
    <el-form-item>
      <el-button type="primary" @click="submitForm">æäº¤</el-button>
    </el-form-item>
  </el-form>
</template>

<script setup>
import { ref, reactive } from 'vue'

const formRef = ref()
const form = reactive({
  projectName: '',
  region: [],
  regionText: '' // å­˜å‚¨åŒºåŸŸæ–‡æœ¬
})

const rules = {
  projectName: [
    { required: true, message: 'è¯·è¾“å…¥é¡¹ç›®åç§°', trigger: 'blur' }
  ],
  region: [
    { required: true, message: 'è¯·é€‰æ‹©åŒºåŸŸ', trigger: 'change' }
  ]
}

const handleRegionChange = (data) => {
  form.regionText = data.labels.join(' / ')
  console.log('åŒºåŸŸä¿¡æ¯:', {
    values: data.values,
    text: form.regionText
  })
}

const submitForm = () => {
  formRef.value.validate((valid) => {
    if (valid) {
      const submitData = {
        projectName: form.projectName,
        region: form.region,
        regionText: form.regionText
      }
      console.log('æäº¤æ•°æ®:', submitData)
      // æäº¤åˆ°åç«¯
    }
  })
}
</script>
```

### 2. **æœç´¢åŠŸèƒ½ä¸­è·å–é€‰æ‹©å†…å®¹**

```vue
<template>
  <div class="search-form">
    <el-form :model="queryParams" ref="queryForm" :inline="true">
      <el-form-item label="é¡¹ç›®åç§°" prop="projectName">
        <el-input
          v-model="queryParams.projectName"
          placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°"
          clearable
        />
      </el-form-item>
      
      <el-form-item label="åŒºåŸŸ" prop="region">
        <RegionCascader
          v-model="queryParams.region"
          placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
          clearable
          @change-with-labels="handleRegionSearch"
        />
      </el-form-item>
      
      <el-form-item>
        <el-button type="primary" @click="handleSearch">æœç´¢</el-button>
        <el-button @click="resetSearch">é‡ç½®</el-button>
      </el-form-item>
    </el-form>
    
    <div class="search-result" v-if="searchResult">
      <h3>æœç´¢ç»“æœ:</h3>
      <p>æœç´¢åŒºåŸŸ: {{ searchResult.regionText }}</p>
      <p>æ‰¾åˆ° {{ searchResult.count }} æ¡è®°å½•</p>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue'

const queryForm = ref()
const queryParams = reactive({
  projectName: '',
  region: []
})

const searchResult = ref(null)

const handleRegionSearch = (data) => {
  console.log('æœç´¢åŒºåŸŸ:', data.labels.join(' / '))
  // å¯ä»¥åœ¨è¿™é‡Œå®ç°å®æ—¶æœç´¢
}

const handleSearch = () => {
  const searchData = {
    projectName: queryParams.projectName,
    region: queryParams.region,
    regionText: queryParams.region.length > 0 ? 'å·²é€‰æ‹©åŒºåŸŸ' : 'æœªé€‰æ‹©åŒºåŸŸ'
  }
  
  console.log('æœç´¢å‚æ•°:', searchData)
  
  // æ¨¡æ‹Ÿæœç´¢ç»“æœ
  searchResult.value = {
    regionText: searchData.regionText,
    count: Math.floor(Math.random() * 100)
  }
}

const resetSearch = () => {
  queryForm.value.resetFields()
  searchResult.value = null
}
</script>

<style scoped>
.search-form {
  padding: 20px;
  background-color: #f9f9f9;
  border-radius: 4px;
}

.search-result {
  margin-top: 20px;
  padding: 15px;
  background-color: #e8f4fd;
  border-radius: 4px;
}
</style>
```

### 3. **æ•°æ®å›æ˜¾æ—¶è®¾ç½®é€‰æ‹©å†…å®¹**

```vue
<template>
  <div>
    <RegionCascader
      ref="regionCascaderRef"
      v-model="selectedRegion"
      placeholder="è¯·é€‰æ‹©çœå¸‚åŒº"
    />
    
    <div class="buttons">
      <el-button @click="setBeijing">è®¾ç½®ä¸ºåŒ—äº¬</el-button>
      <el-button @click="setShanghai">è®¾ç½®ä¸ºä¸Šæµ·</el-button>
      <el-button @click="setGuangzhou">è®¾ç½®ä¸ºå¹¿å·</el-button>
      <el-button @click="resetRegion">é‡ç½®</el-button>
    </div>
    
    <div class="result">
      <h3>å½“å‰é€‰æ‹©:</h3>
      <p>å€¼: {{ selectedRegion }}</p>
      <p>æ–‡æœ¬: {{ regionText }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref, watch } from 'vue'

const regionCascaderRef = ref()
const selectedRegion = ref([])
const regionText = ref('')

// ç›‘å¬é€‰æ‹©å˜åŒ–
watch(selectedRegion, async (newValue) => {
  if (newValue && newValue.length > 0) {
    const info = regionCascaderRef.value.getSelectedInfo()
    regionText.value = info.text
  } else {
    regionText.value = ''
  }
})

// é¢„è®¾çš„åŒºåŸŸæ•°æ®ï¼ˆå®é™…ä½¿ç”¨æ—¶åº”è¯¥ä»åç«¯è·å–ï¼‰
const regionData = {
  beijing: [110000, 110100, 110101], // åŒ—äº¬å¸‚ åŒ—äº¬å¸‚ ä¸œåŸåŒº
  shanghai: [310000, 310100, 310101], // ä¸Šæµ·å¸‚ ä¸Šæµ·å¸‚ é»„æµ¦åŒº
  guangzhou: [440000, 440100, 440103] // å¹¿ä¸œçœ å¹¿å·å¸‚ è”æ¹¾åŒº
}

const setBeijing = () => {
  regionCascaderRef.value.setValue(regionData.beijing)
}

const setShanghai = () => {
  regionCascaderRef.value.setValue(regionData.shanghai)
}

const setGuangzhou = () => {
  regionCascaderRef.value.setValue(regionData.guangzhou)
}

const resetRegion = () => {
  regionCascaderRef.value.reset()
}
</script>
```

## ğŸ“Š æ•°æ®ç»“æ„è¯´æ˜

### é€‰æ‹©å†…å®¹çš„æ•°æ®ç»“æ„

```javascript
// é€‰ä¸­çš„å€¼ï¼ˆIDæ•°ç»„ï¼‰
selectedValues = [110000, 110100, 110101]

// é€‰ä¸­çš„æ ‡ç­¾ï¼ˆåç§°æ•°ç»„ï¼‰
selectedLabels = ['åŒ—äº¬å¸‚', 'åŒ—äº¬å¸‚', 'ä¸œåŸåŒº']

// å®Œæ•´ä¿¡æ¯å¯¹è±¡
selectedInfo = {
  values: [110000, 110100, 110101],
  labels: ['åŒ—äº¬å¸‚', 'åŒ—äº¬å¸‚', 'ä¸œåŸåŒº'],
  text: 'åŒ—äº¬å¸‚ / åŒ—äº¬å¸‚ / ä¸œåŸåŒº'
}
```

### API æ¥å£æ•°æ®ç»“æ„

```javascript
// çœä»½æ•°æ®
{
  id: 110000,
  name: 'åŒ—äº¬å¸‚',
  level: 1
}

// åŸå¸‚æ•°æ®
{
  id: 110100,
  name: 'åŒ—äº¬å¸‚',
  level: 2,
  parent_id: 110000
}

// åŒºå¿æ•°æ®
{
  id: 110101,
  name: 'ä¸œåŸåŒº',
  level: 3,
  parent_id: 110100
}
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. **æ€§èƒ½ä¼˜åŒ–**

```vue
<script setup>
import { ref, debounce } from 'lodash-es'

const selectedRegion = ref([])
const regionText = ref('')

// é˜²æŠ–å¤„ç†ï¼Œé¿å…é¢‘ç¹è¯·æ±‚
const debouncedGetLabels = debounce(async (values) => {
  if (values && values.length > 0) {
    // è·å–æ ‡ç­¾é€»è¾‘
  }
}, 300)

const handleRegionChange = (values) => {
  debouncedGetLabels(values)
}
</script>
```

### 2. **é”™è¯¯å¤„ç†**

```vue
<script setup>
const handleRegionChange = async (values) => {
  try {
    if (values && values.length > 0) {
      const info = regionCascaderRef.value.getSelectedInfo()
      console.log('é€‰æ‹©æˆåŠŸ:', info)
    }
  } catch (error) {
    console.error('è·å–é€‰æ‹©å†…å®¹å¤±è´¥:', error)
    // é”™è¯¯å¤„ç†é€»è¾‘
  }
}
</script>
```

### 3. **æ•°æ®éªŒè¯**

```vue
<script setup>
const validateRegion = (values) => {
  if (!values || values.length === 0) {
    return { valid: false, message: 'è¯·é€‰æ‹©åŒºåŸŸ' }
  }
  
  if (values.length < 2) {
    return { valid: false, message: 'è¯·é€‰æ‹©å®Œæ•´çš„çœå¸‚ä¿¡æ¯' }
  }
  
  return { valid: true, message: 'é€‰æ‹©æœ‰æ•ˆ' }
}

const handleRegionChange = (values) => {
  const validation = validateRegion(values)
  if (!validation.valid) {
    console.warn(validation.message)
    return
  }
  
  // å¤„ç†æœ‰æ•ˆé€‰æ‹©
}
</script>
```

## ğŸ” å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è·å–é€‰ä¸­çš„å®Œæ•´è·¯å¾„æ–‡æœ¬ï¼Ÿ
A: ä½¿ç”¨ `@change-with-labels` äº‹ä»¶æˆ–è°ƒç”¨ `getSelectedInfo()` æ–¹æ³•ã€‚

### Q: å¦‚ä½•è®¾ç½®é»˜è®¤å€¼å¹¶æ˜¾ç¤ºå¯¹åº”æ–‡æœ¬ï¼Ÿ
A: ä½¿ç”¨ `setValue()` æ–¹æ³•è®¾ç½®å€¼ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨è·å–å¯¹åº”çš„æ–‡æœ¬æ ‡ç­¾ã€‚

### Q: å¦‚ä½•å¤„ç†å¼‚æ­¥åŠ è½½çš„æ ‡ç­¾è·å–ï¼Ÿ
A: ç»„ä»¶å†…éƒ¨å·²ç»å¤„ç†äº†å¼‚æ­¥é€»è¾‘ï¼Œä½¿ç”¨ `async/await` ç¡®ä¿æ•°æ®æ­£ç¡®è·å–ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰æ ‡ç­¾åˆ†éš”ç¬¦ï¼Ÿ
A: å¯ä»¥é€šè¿‡ä¿®æ”¹ `getSelectedInfo()` æ–¹æ³•ä¸­çš„ `join(' / ')` éƒ¨åˆ†æ¥è‡ªå®šä¹‰åˆ†éš”ç¬¦ã€‚

## ğŸ“ æ€»ç»“

é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œæ‚¨å¯ä»¥è½»æ¾è·å– el-cascader çš„é€‰æ‹©å†…å®¹ï¼š

1. **åŸºç¡€ç”¨æ³•**ï¼šé€šè¿‡ `v-model` è·å–é€‰ä¸­çš„å€¼
2. **é«˜çº§ç”¨æ³•**ï¼šé€šè¿‡äº‹ä»¶è·å–å€¼å’Œæ ‡ç­¾
3. **ç»„ä»¶æ–¹æ³•**ï¼šé€šè¿‡ç»„ä»¶å¼•ç”¨è°ƒç”¨æ–¹æ³•è·å–å®Œæ•´ä¿¡æ¯
4. **å®é™…åº”ç”¨**ï¼šåœ¨è¡¨å•ã€æœç´¢ã€æ•°æ®å›æ˜¾ç­‰åœºæ™¯ä¸­çš„åº”ç”¨

é€‰æ‹©é€‚åˆæ‚¨éœ€æ±‚çš„æ–¹æ³•ï¼Œå®ç°é«˜æ•ˆçš„åŒºåŸŸé€‰æ‹©åŠŸèƒ½ï¼
